<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Wegweiser</title>
  <link rel="stylesheet" href="sidepanel.css">
</head>
<body>
  <div id="main-content">
    <div id="top-section">
      <div id="header" role="banner">
        <h1 style="font-size: inherit; margin: 0; font-weight: inherit;">Wegweiser</h1>
        <div style="display: flex; gap: 8px;">
          <div id="spaces-btn" title="Spaces" aria-label="Open Spaces" role="button" tabindex="0">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
            </svg>
          </div>
          <div id="settings-icon" title="Open settings" aria-label="Open settings" role="button" tabindex="0">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z"/>
            </svg>
          </div>
        </div>
      </div>

      <div id="balance-row">
        <span id="balance-label">Balance:</span>
        <span id="balance" aria-live="polite" aria-atomic="true">â€“</span>
        <button id="balance-refresh" type="button" aria-label="Refresh account balance">Refresh</button>
      </div>
    </div>

    <div id="answer-section" role="main" aria-label="Conversation responses">
      <div class="typing-indicator" id="typing-indicator" role="status" aria-live="polite" aria-label="AI is thinking">
        <div class="typing-dot"></div>
        <div class="typing-dot"></div>
        <div class="typing-dot"></div>
      </div>
      <div id="answer" aria-live="polite"></div>
      <button id="clear-answer-btn" class="clear-btn" style="display: none;" aria-label="Clear all answers and conversation context">Clear Answers</button>
    </div>
  </div>

  <div id="bottom-section">
    <div id="prompt-container">
      <label for="prompt" class="sr-only">Ask a question</label>
      <textarea id="prompt" placeholder="Ask something... (Enter or Ctrl+Enter to send, Shift+Enter for new line)" aria-label="Ask a question"></textarea>
      <div id="buttons-container" role="group" aria-label="Action buttons">
        <button id="askBtn" type="button" aria-label="Send message">Ask</button>
        <button id="summarizeBtn" type="button" aria-label="Summarize current page">Summarize Page</button>
        <button id="stopBtn" type="button" style="display: none;" aria-label="Stop generation">Stop</button>
      </div>
      <div id="toggles-row" role="group" aria-label="Feature toggles">
        <div class="toggle-btn" id="web-search-toggle" title="Enable Web Search" aria-label="Toggle web search" aria-pressed="false" role="button" tabindex="0">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
          </svg>
        </div>
        <span class="toggle-label">Web Search</span>

        <div class="toggle-btn" id="reasoning-toggle" title="Enable Reasoning" aria-label="Toggle reasoning mode" aria-pressed="false" role="button" tabindex="0">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M9 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H9v1zm3-19C8.14 2 5 5.14 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.86-3.14-7-7-7zm2.85 11.1l-.85.6V16h-4v-2.3l-.85-.6C7.8 12.16 7 10.63 7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 1.63-.8 3.16-2.15 4.1z"/>
          </svg>
        </div>
        <span class="toggle-label">Reasoning</span>

        <div class="toggle-btn" id="image-toggle" title="Enable Image Mode" aria-label="Toggle image mode" aria-pressed="false" role="button" tabindex="0">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zm-2 0H5V5h14v14zM8.5 13.5l2.5 3 3.5-4.5 4.5 6H6l2.5-4.5z"/>
          </svg>
        </div>
        <span class="toggle-label">Image</span>

        <div id="context-viz-section">
          <!-- Context button will appear here when context exists -->
        </div>
      </div>
      <div id="meta" role="status" aria-live="polite"></div>
      <div id="estimated-cost" style="display: none;" aria-live="polite" aria-atomic="true"></div>
    </div>

    <div id="model-section">
      <div id="model-label">Model</div>
      <div id="model-input-wrapper">
        <input type="text" id="model-input" placeholder="Type to search models..." />
        <select id="model-select" style="display: none;">
          <option value="">Loading...</option>
        </select>
      </div>
      <div id="model-status"></div>
    </div>
  </div>

  <script src="../lib/purify.min.js"></script>
  <script src="../modules/toast.js"></script>
  <script src="../modules/markdown.js"></script>
  <script src="../modules/sources.js"></script>
  <script src="../modules/source-cards.js"></script>
  <script src="../modules/image-cards.js"></script>
  <script src="../modules/exporter.js"></script>
  <script src="../modules/theme.js"></script>
  <script src="../shared/utils.js"></script>
  <script src="../shared/image-cache.js"></script>
  <script src="../modules/models-dropdown.js"></script>
  <script src="../modules/context-viz.js"></script>
  <script src="sidepanel.js"></script>
</body>
</html>

